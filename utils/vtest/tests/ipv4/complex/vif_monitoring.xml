<?xml version="1.0"?>
<test>
    <test_name>Interface test - Add virtual interface, monitoring interface and packet mirroring </test_name>
    <message>
        <vr_interface_req>
            <h_op>Add</h_op>
            <vifr_type>3</vifr_type>
            <vifr_idx>1</vifr_idx>
            <vifr_name>1</vifr_name>
            <vifr_transport>2</vifr_transport>
            <vifr_vrf>0</vifr_vrf>
            <vifr_mac>de:ad:be:ef:00:02</vifr_mac>
            <vifr_mtu>1514</vifr_mtu>
        </vr_interface_req>
        <return>0</return>
    </message>
    <message>
        <vr_interface_req>
            <h_op>Add</h_op>
            <vifr_type>2</vifr_type>
            <vifr_idx>0</vifr_idx>
            <vifr_name>0</vifr_name>
            <vifr_transport>2</vifr_transport>
            <vifr_vrf>0</vifr_vrf>
            <vifr_flags>8704</vifr_flags>
            <vifr_mac>bc:30:5b:cb:03:8d</vifr_mac>
            <vifr_mtu>1514</vifr_mtu>
        </vr_interface_req>
        <return>0</return>
    </message>
    <message>
        <vr_interface_req>
            <h_op>Add</h_op>
            <vifr_type>9</vifr_type>
            <vifr_idx>4351</vifr_idx>
            <vifr_name>mon0</vifr_name>
            <vifr_transport>0</vifr_transport>
            <vifr_vrf>0</vifr_vrf>
            <vifr_flags>0</vifr_flags>
            <vifr_vif_os_idx>0</vifr_vif_os_idx>
            <vifr_isid>0</vifr_isid>
            <vifr_mtu>1514</vifr_mtu>
            <vifr_mac>00:02:00:00:00:00</vifr_mac>
        </vr_interface_req>
        <return>0</return>
    </message>
    <message>
        <vr_nexthop_req>
            <h_op>Add</h_op>
            <nhr_type>2</nhr_type>
            <nhr_id>12</nhr_id>
            <nhr_encap_oif_id>0</nhr_encap_oif_id>
            <nhr_encap>54:9f:35:08:6b:a6:de:ad:be:ef:00:02:08:00</nhr_encap>
            <nhr_vrf>0</nhr_vrf>
            <nhr_flags>5</nhr_flags>
        </vr_nexthop_req>
        <return>0</return>
    </message>
    <message>
        <vr_route_req>
            <h_op>Add</h_op>
            <rtr_family>7</rtr_family>
            <rtr_nh_id>12</rtr_nh_id>
            <rtr_mac>54:9f:35:08:6b:a6</rtr_mac>
            <rtr_vrf_id>0</rtr_vrf_id>
        </vr_route_req>
        <return>0</return>
	    </message>
    <message>
        <vr_interface_req>
            <h_op>Get</h_op>
            <vifr_idx>1</vifr_idx>
        </vr_interface_req>
        <return>0</return>
        <expect>
            <vr_interface_req_expect>
                <vifr_idx>1</vifr_idx>
                <vifr_transport>2</vifr_transport>
                <vifr_vrf>0</vifr_vrf>
                <vifr_mtu>1514</vifr_mtu>
            </vr_interface_req_expect>
        </expect>
    </message>


    <packet>
        <pcap_input_file>/opt/stack/contrail/vrouter/utils/vtest/tests/ipv4/pcaps/monitoring.pcap</pcap_input_file>
	<tx_interface>
            <vif_index>1</vif_index>
            <vif_mac>de:ad:be:ef:00:02</vif_mac>
        </tx_interface>
        <pcap_expected_file>/opt/stack/contrail/vrouter/utils/vtest/tests/ipv4/pcaps/monitoring.pcap</pcap_expected_file>
	<rx_interface>
            <vif_index>4351</vif_index>
            <vif_type>9</vif_type>
            <vif_name>mon0</vif_name>
        </rx_interface>
    </packet>

</test>

